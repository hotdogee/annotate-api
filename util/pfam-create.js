const logger = require('./logger')
const pfam = require('./pfam')

// async main
;(async () => {
  try {
    const id = 'c5179bf95c52872dd0be1207dd9898dc'
    const result = await pfam.create({
      sequence:
        'MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN'
    })
    // const result = await pfam.find({
    //   query: {
    //     _id: 'c5179bf95c52872dd0be1207dd9898dc'
    //   }
    // })
    logger.info(JSON.stringify(result, null, 0))
    // {"seq":"MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN","predictions":[{"classes":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,4877,1,1],"top_probs":[[0.997444,0.000282054,0.000102332],[0.997968,0.000131374,0.000126066],[0.99692,0.000428862,0.000278933],[0.997397,0.000422197,0.000207456],[0.996028,0.000993942,0.000317281],[0.996538,0.000910947,0.000240429],[0.996071,0.00131023,0.000227068],[0.99484,0.00200058,0.000421379],[0.995103,0.0020761,0.000330702],[0.995357,0.0020245,0.000306039],[0.99423,0.00268906,0.000394127],[0.993099,0.00345266,0.000355885],[0.992882,0.00371773,0.000337084],[0.992017,0.00440202,0.000355949],[0.991739,0.00443457,0.000482615],[0.99274,0.00403767,0.000377947],[0.992501,0.0044295,0.000329193],[0.99302,0.00408881,0.000354331],[0.994025,0.0031792,0.000422031],[0.994751,0.00261118,0.000333282],[0.995671,0.00158521,0.000345096],[0.996467,0.00127791,0.000288093],[0.99492,0.00139881,0.000805606],[0.991378,0.00303585,0.000911789],[0.978042,0.00730492,0.00387864],[0.960107,0.0138488,0.00975436],[0.948378,0.0311425,0.00395123],[0.659853,0.324351,0.00344731],[0.68776,0.304625,0.001501],[0.970663,0.0280448,0.000412624],[0.997507,0.00225827,0.0000865316],[0.999537,0.000402701,0.0000168713],[0.999798,0.000174823,0.00000863342],[0.999773,0.000202767,0.00000590885],[0.99978,0.000196326,0.00000414556],[0.999759,0.000213146,0.00000401884],[0.999772,0.00020071,0.00000244687],[0.999835,0.000147076,0.00000192983],[0.999865,0.000119442,0.00000198254],[0.999864,0.000120563,0.00000229362],[0.999895,0.0000925089,0.00000192953],[0.999893,0.0000952935,0.00000188756],[0.999912,0.0000765089,0.00000217755],[0.99991,0.0000800014,0.00000191189],[0.9999,0.0000889085,0.00000197527],[0.999853,0.00013101,0.00000246987],[0.999871,0.000114933,0.00000255711],[0.999877,0.000108144,0.00000294745],[0.999859,0.000123143,0.00000332724],[0.999846,0.000134107,0.00000369717],[0.999812,0.000164335,0.00000420849],[0.999815,0.00016115,0.0000042308],[0.999802,0.000171875,0.00000423831],[0.999816,0.000158958,0.00000400454],[0.999796,0.000176305,0.00000416675],[0.999799,0.000172951,0.0000040903],[0.999769,0.000199198,0.00000443062],[0.999767,0.00019967,0.00000439819],[0.999729,0.000232605,0.00000494708],[0.999704,0.000253811,0.00000503536],[0.999679,0.000273131,0.00000532655],[0.999625,0.000318704,0.00000608578],[0.999626,0.000315956,0.00000604396],[0.999599,0.00033961,0.00000635404],[0.999578,0.000352254,0.00000660969],[0.999502,0.000412708,0.000008597],[0.9995,0.000416731,0.00000846375],[0.999516,0.00039704,0.00000956106],[0.999473,0.000429295,0.0000113977],[0.999487,0.000411156,0.0000115492],[0.999422,0.000462199,0.0000141268],[0.999485,0.000408784,0.0000115004],[0.99945,0.000437312,0.0000117222],[0.999466,0.000418782,0.0000114582],[0.999328,0.000527513,0.0000152186],[0.999332,0.000521384,0.0000150177],[0.999295,0.000552041,0.0000153034],[0.999386,0.000481323,0.000013052],[0.999427,0.00044568,0.0000133118],[0.999408,0.000453166,0.0000165518],[0.99942,0.000441127,0.0000172696],[0.999596,0.000304658,0.000013504],[0.999681,0.00023538,0.0000114195],[0.999594,0.000299141,0.0000159264],[0.999481,0.000387182,0.0000212362],[0.999384,0.000470744,0.0000246363],[0.999296,0.000542875,0.0000279616],[0.99899,0.000799426,0.0000361453],[0.998401,0.0013181,0.0000468972],[0.99778,0.00187251,0.0000546126],[0.99604,0.00341757,0.0000816497],[0.992808,0.00634743,0.000133818],[0.988946,0.00991765,0.000175188],[0.970627,0.0271132,0.00035328],[0.936435,0.0601007,0.000502448],[0.837202,0.158748,0.000554726],[0.85475,0.142398,0.00036893],[0.999999,3.96291e-7,3.10402e-7]],"top_classes":[[1,7991,3496],[1,7991,5416],[1,5416,7991],[1,5416,3496],[1,5416,7991],[1,5416,3496],[1,5416,3496],[1,5416,972],[1,5416,972],[1,5416,972],[1,5416,972],[1,5416,972],[1,5416,972],[1,5416,15765],[1,5416,15765],[1,5416,15765],[1,5416,5428],[1,5416,5428],[1,5416,5428],[1,5416,5428],[1,5416,15765],[1,5416,15765],[1,5416,6021],[1,6021,15203],[1,6021,5416],[1,4877,6021],[1,4877,15203],[1,4877,5416],[4877,1,5416],[4877,1,5416],[4877,1,5416],[4877,1,5416],[4877,1,2807],[4877,1,2807],[4877,1,2807],[4877,1,5416],[4877,1,5416],[4877,1,15137],[4877,1,15137],[4877,1,15137],[4877,1,15137],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,7604],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,2758],[4877,1,3695],[4877,1,3695],[4877,1,3695],[4877,1,3695],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[4877,1,13811],[1,4877,3137],[1,295,371]]}],"_id":"c5179bf95c52872dd0be1207dd9898dc"}
  } catch (error) {
    logger.error(error)
  } finally {
    process.exit()
  }
})()

const expected = {
  _id: '5e2d489758c74821b5e1508c2e2b56e2',
  seq: 'MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN',
  predictions: [
    {
      top_classes: [
        [1, 4085, 14772],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 4085],
        [1, 14772, 6021],
        [1, 14772, 4085],
        [1, 14772, 6021],
        [1, 14772, 6021],
        [1, 14772, 6021],
        [1, 14772, 6021],
        [1, 6021, 14772],
        [1, 14772, 3133],
        [1, 14772, 6021],
        [1, 14772, 3133],
        [1, 14772, 3133],
        [1, 14772, 3834],
        [1, 14772, 3834],
        [1, 14772, 11155],
        [1, 4877, 3834],
        [1, 4877, 3834],
        [1, 4877, 3834],
        [1, 4877, 3834],
        [1, 4877, 3834],
        [1, 4877, 3834],
        [4877, 1, 1262],
        [4877, 1, 1262],
        [4877, 1, 1262],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 3834],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 5065],
        [4877, 1, 5065],
        [4877, 1, 5065],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 7604],
        [4877, 1, 2806],
        [4877, 1, 2806],
        [4877, 1, 2806],
        [4877, 1, 2806],
        [4877, 1, 2806],
        [4877, 1, 13811],
        [4877, 1, 2806],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [4877, 1, 13811],
        [1, 4877, 13811],
        [1, 4877, 13811],
        [1, 4877, 13811],
        [1, 4877, 13811],
        [1, 4877, 13811],
        [1, 4877, 1689],
        [1, 3834, 13223]
      ],
      top_probs: [
        [0.999652386, 0.0000356852579, 0.0000353277537],
        [0.999199808, 0.000104698149, 0.000101355348],
        [0.99901557, 0.000164791971, 0.0000929546],
        [0.998711109, 0.000222139046, 0.000147500279],
        [0.998654127, 0.000288347161, 0.00013284749],
        [0.998264134, 0.00037335197, 0.000204366472],
        [0.998114705, 0.000458148133, 0.000197741698],
        [0.998042345, 0.000521494, 0.000214408225],
        [0.998076797, 0.000490739127, 0.000296558603],
        [0.99804616, 0.000589268806, 0.000238533161],
        [0.997713327, 0.000732729328, 0.000351052091],
        [0.997515202, 0.0009405163, 0.000238985813],
        [0.997918069, 0.000776095316, 0.000294578145],
        [0.997749627, 0.00069224264, 0.000565965893],
        [0.997079134, 0.00116335857, 0.000295160891],
        [0.997954726, 0.000680272409, 0.000389751891],
        [0.996983111, 0.000914827629, 0.000720829761],
        [0.996089935, 0.00131240394, 0.00043747024],
        [0.995530665, 0.00134999352, 0.000530500954],
        [0.995341659, 0.001428421, 0.000680508441],
        [0.996967733, 0.000829796365, 0.000282237597],
        [0.997666121, 0.00046066806, 0.00037032523],
        [0.997497, 0.000432049652, 0.000395754061],
        [0.996223927, 0.000672464201, 0.000371733215],
        [0.994832754, 0.00102878513, 0.000569574768],
        [0.990973532, 0.00379714672, 0.000890013704],
        [0.980309665, 0.0139485514, 0.00117035292],
        [0.942359567, 0.0510896817, 0.00119679212],
        [0.816222847, 0.177090168, 0.000729454739],
        [0.586814404, 0.407143325, 0.000811421371],
        [0.803944707, 0.192713901, 0.000587144168],
        [0.886912823, 0.110852741, 0.000334777375],
        [0.934041262, 0.0647798702, 0.00013379853],
        [0.941038251, 0.0578701496, 0.000136694274],
        [0.960209131, 0.0391264036, 0.0000804931769],
        [0.953774631, 0.045386456, 0.0000738515664],
        [0.972162, 0.0272139106, 0.0000765668301],
        [0.975966275, 0.0234014317, 0.000077651719],
        [0.968434393, 0.0306880604, 0.0000794082],
        [0.968035758, 0.0309894662, 0.0000842066365],
        [0.981398404, 0.01791781, 0.0000587716604],
        [0.986350477, 0.0130707724, 0.0000586016722],
        [0.985435665, 0.013886895, 0.0000777096429],
        [0.98849237, 0.0109408498, 0.0000834254315],
        [0.989732683, 0.0097409, 0.000098494922],
        [0.98979342, 0.00963903, 0.000120410681],
        [0.991526425, 0.007941355, 0.000125741266],
        [0.991151035, 0.00823733769, 0.000142549703],
        [0.991180718, 0.0081720138, 0.000160018695],
        [0.990736306, 0.00853884872, 0.00019002326],
        [0.991355836, 0.00797059294, 0.00016370244],
        [0.991619825, 0.00772301527, 0.000167914608],
        [0.992475212, 0.00693792291, 0.000152006702],
        [0.992630124, 0.00681439182, 0.000146232982],
        [0.992928565, 0.00655529369, 0.00013368731],
        [0.99323225, 0.0062892884, 0.000125086852],
        [0.993797481, 0.00576781295, 0.000112896734],
        [0.9942047, 0.00540435035, 0.0000978333555],
        [0.994205773, 0.00541455, 0.0000907246504],
        [0.994506657, 0.00514292158, 0.0000823443916],
        [0.994533777, 0.00514288479, 0.0000716808572],
        [0.99420023, 0.00546642486, 0.0000686656786],
        [0.99427247, 0.00540569844, 0.0000642584419],
        [0.99440515, 0.00529011246, 0.000059750877],
        [0.994243801, 0.00545624783, 0.0000563706453],
        [0.994220734, 0.00547809247, 0.0000517768203],
        [0.994208217, 0.00549514359, 0.0000487839607],
        [0.993889928, 0.00580759533, 0.000047042824],
        [0.99356693, 0.00611000741, 0.0000543947535],
        [0.993109941, 0.00655234093, 0.0000569401],
        [0.992691338, 0.0069374349, 0.0000708545122],
        [0.992788, 0.00685082097, 0.0000661659142],
        [0.992836297, 0.00680235215, 0.0000634062817],
        [0.99217248, 0.00743989926, 0.0000651079754],
        [0.990776479, 0.00874436274, 0.0000882852473],
        [0.99028486, 0.00919686, 0.000101932164],
        [0.989839315, 0.00961942, 0.000110555207],
        [0.988957584, 0.0104344115, 0.000129857479],
        [0.988510489, 0.0108816754, 0.000131244407],
        [0.985789359, 0.0134199094, 0.000168157931],
        [0.984058321, 0.0149628986, 0.000230778809],
        [0.983531058, 0.0154524855, 0.000267275958],
        [0.982958615, 0.0160012711, 0.000292348821],
        [0.977018654, 0.0215670876, 0.000420719909],
        [0.966717839, 0.0313097388, 0.00063094811],
        [0.959100425, 0.0386675633, 0.000764370197],
        [0.9474, 0.0501441322, 0.000867466966],
        [0.919074118, 0.0772853419, 0.00135622767],
        [0.868044436, 0.12711823, 0.0017597574],
        [0.800677299, 0.194115341, 0.00191863149],
        [0.639502764, 0.351934403, 0.00304352585],
        [0.550257266, 0.436998874, 0.00433004322],
        [0.680032909, 0.307209611, 0.00394102046],
        [0.874046504, 0.112814575, 0.00347928074],
        [0.928054035, 0.061314743, 0.00243411143],
        [0.926555097, 0.0620202906, 0.0023087787],
        [0.985912621, 0.0042780959, 0.0040890458],
        [0.999850392, 0.0000208740839, 0.0000090066369]
      ],
      classes: [
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4877, 4877,
        4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877,
        4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877,
        4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877,
        4877, 4877, 4877, 4877, 4877, 4877, 4877, 4877, 1, 1, 1, 1, 1, 1, 1
      ]
    }
  ],
  domainMap: {
    '1': {
      pfamAcc: 'NO_DOMAIN',
      pfamId: 'NO_DOMAIN',
      pfamDesc: 'No Domain',
      clanAcc: '',
      clanId: ''
    },
    '1262': {
      pfamAcc: 'PF01607',
      pfamId: 'CBM_14',
      pfamDesc: 'Chitin binding Peritrophin-A domain',
      clanAcc: 'CL0155',
      clanId: 'CBM_14_19'
    },
    '1689': {
      pfamAcc: 'PF00014',
      pfamId: 'Kunitz_BPTI',
      pfamDesc: 'Kunitz/Bovine pancreatic trypsin inhibitor domain',
      clanAcc: '',
      clanId: ''
    },
    '2806': {
      pfamAcc: 'PF01822',
      pfamId: 'WSC',
      pfamDesc: 'WSC domain',
      clanAcc: '',
      clanId: ''
    },
    '3133': {
      pfamAcc: 'PF05305',
      pfamId: 'DUF732',
      pfamDesc: 'Protein of unknown function (DUF732)',
      clanAcc: '',
      clanId: ''
    },
    '3834': {
      pfamAcc: 'PF00050',
      pfamId: 'Kazal_1',
      pfamDesc: 'Kazal-type serine protease inhibitor domain',
      clanAcc: 'CL0005',
      clanId: 'Kazal'
    },
    '4085': {
      pfamAcc: 'PF16981',
      pfamId: 'Chi-conotoxin',
      pfamDesc: 'chi-Conotoxin or t superfamily',
      clanAcc: 'CL0083',
      clanId: 'Omega_toxin'
    },
    '4877': {
      pfamAcc: 'PF00049',
      pfamId: 'Insulin',
      pfamDesc: 'Insulin/IGF/Relaxin family',
      clanAcc: 'CL0239',
      clanId: 'Insulin'
    },
    '5065': {
      pfamAcc: 'PF00193',
      pfamId: 'Xlink',
      pfamDesc: 'Extracellular link domain',
      clanAcc: 'CL0056',
      clanId: 'C_Lectin'
    },
    '6021': {
      pfamAcc: 'PF13308',
      pfamId: 'YARHG',
      pfamDesc: 'YARHG domain',
      clanAcc: '',
      clanId: ''
    },
    '7604': {
      pfamAcc: 'PF09691',
      pfamId: 'T2SS_PulS_OutS',
      pfamDesc: 'Type II secretion system pilotin lipoprotein (PulS_OutS)',
      clanAcc: '',
      clanId: ''
    },
    '11155': {
      pfamAcc: 'PF00446',
      pfamId: 'GnRH',
      pfamDesc: 'Gonadotropin-releasing hormone',
      clanAcc: '',
      clanId: ''
    },
    '13223': {
      pfamAcc: 'PF02083',
      pfamId: 'Urotensin_II',
      pfamDesc: 'Urotensin II',
      clanAcc: '',
      clanId: ''
    },
    '13811': {
      pfamAcc: 'PF03488',
      pfamId: 'Ins_beta',
      pfamDesc: 'Nematode insulin-related peptide beta type',
      clanAcc: 'CL0239',
      clanId: 'Insulin'
    },
    '14772': {
      pfamAcc: 'PF05324',
      pfamId: 'Sperm_Ag_HE2',
      pfamDesc: 'Sperm antigen HE2',
      clanAcc: '',
      clanId: ''
    }
  }
}
